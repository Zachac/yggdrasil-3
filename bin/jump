#!/bin/bash

if [ "$#" -lt 1 ] || [ -z "$*"]; then
	echo "No location given"
	$(exit 1)
elif [ grep -q '[.*]' <<< $* ]; then
	echo "Illegal charachters in jump command: $*"
	$(exit 2)	
elif ! [ -f "$ROOMS/$*/description" ]; then
	echo "Room not found: $*"
	$(exit 3)
else
	prev_location=$(pwd)

	if cd "$ROOMS/$*"; then
		location=$($BIN/location)
		if [ ! -d "players" ]; then
			mkdir -p "players"
		fi

		ln -sr "$USERS/$USERNAME" "players/$USERNAME"
		rm "$prev_location/players/$USERNAME"
		save user location
	fi
fi 2>/dev/null

