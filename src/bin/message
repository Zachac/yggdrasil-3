#!/bin/bash


if ! flock -n "$USERS/$1/lock" true && [ -f "$USERS/$1/proc" ]; then
	
	proc="$(cat "$USERS/$1/proc")" 
	
	if kill -s 0 "$proc"; then
		shift
		dd conv=nocreat status=none iflag=nonblock of="/proc/$proc/fd/31" <<<"$*"
	else
		echo "$1 is fazing out of reality and missed your message"
	fi

else
	echo "$1 is not online"
fi 2>/dev/null



